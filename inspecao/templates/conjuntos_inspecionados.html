{% extends "base.html" %}

{% load static %}

{% block title %} <title>Inspeção Montagem</title> {% endblock %}

{% block links %}

    <link rel="stylesheet" href="/static/css/inspecao.css">
    <link rel="stylesheet" href="/static/css/select2.css">

{% endblock %}

{% block content %}


<div class="d-flex justify-content-between align-items-baseline">
    <h2 class="my-4">Conjuntos Inspecionados Montagem</h2>
    <button class="btn btn-primary" id="btn-abrir-modal-adicionar">Adicionar Conjunto</button>
</div>

<table class="table" id="tabela-conjuntos">
    <thead>
        <tr>
            <th>Código</th>
            <th>Descrição</th>
            <th>Remover</th>
        </tr>
    </thead>
    <tbody>
        {% for conjunto in conjuntos %}
        <tr>
            <td>{{ conjunto.codigo }}</td>
            <td>{{ conjunto.descricao }}</td>
            <td>
                <div class="dropdown">
                    <button class="btn btn-danger dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false">
                      Remover
                    </button>
                    <ul class="dropdown-menu">
                      <li><button class="dropdown-item abrir-modal-remover" type="button">Remover</button></li>
                    </ul>
                </div>
            </td>
        </tr>
        {% endfor %}
    </tbody>
</table>

<!-- Paginação aqui -->
<nav aria-label="Navegação da tabela">
    <ul class="pagination" id="pagination">
    </ul>
</nav>

{% include 'modal_inspecao/modal_inspecao_conjuntos_inspecionados.html' %}

{% endblock %}

{% block scripts %}

<script src="{% static 'js/montagem/conjunto-inspecionar.js' %}"></script>

<script>
    document.addEventListener('DOMContentLoaded', function() {
        const rows = document.querySelectorAll('#tabela-conjuntos tbody tr');
        const rowsPerPage = 10;
        const pagination = document.getElementById('pagination');
        let currentPage = 1;
        const totalPages = Math.ceil(rows.length / rowsPerPage);
    
        function showPage(page) {
            currentPage = page;
            const start = (page - 1) * rowsPerPage;
            const end = start + rowsPerPage;
    
            rows.forEach((row, index) => {
                row.style.display = (index >= start && index < end) ? '' : 'none';
            });
    
            updatePagination();
        }
    
        function updatePagination() {
            pagination.innerHTML = '';
    
            function createPageItem(text, page = null, active = false, disabled = false) {
                const li = document.createElement('li');
                li.className = 'page-item' + (active ? ' active' : '') + (disabled ? ' disabled' : '');
                const a = document.createElement('a');
                a.className = 'page-link';
                a.href = '#';
                a.textContent = text;
                if (page && !disabled) {
                    a.addEventListener('click', (e) => {
                        e.preventDefault();
                        showPage(page);
                    });
                }
                li.appendChild(a);
                pagination.appendChild(li);
            }
    
            if (currentPage > 1) {
                createPageItem('Anterior', currentPage - 1);
            } else {
                createPageItem('Anterior', null, false, true);
            }
    
            let pageLinksToShow = 1; // quantas páginas vizinhas exibir
    
            if (currentPage > 1 + pageLinksToShow) {
                createPageItem(1, 1);
                if (currentPage > 2 + pageLinksToShow) {
                    createPageItem('...');
                }
            }
    
            for (let i = currentPage - pageLinksToShow; i <= currentPage + pageLinksToShow; i++) {
                if (i > 0 && i <= totalPages) {
                    createPageItem(i, i, currentPage === i);
                }
            }
    
            if (currentPage < totalPages - pageLinksToShow) {
                if (currentPage < totalPages - pageLinksToShow - 1) {
                    createPageItem('...');
                }
                createPageItem(totalPages, totalPages);
            }
    
            if (currentPage < totalPages) {
                createPageItem('Próximo', currentPage + 1);
            } else {
                createPageItem('Próximo', null, false, true);
            }
        }
    
        showPage(1);
    });
    </script>
    

{% endblock %}
